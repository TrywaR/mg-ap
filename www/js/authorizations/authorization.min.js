function authorization(){if(session_key){active_buttons();var t=new Object;$.ajax({url:site_url+"api/v1/accounts/profile/",data:t,method:"GET",headers:{Authorization:"token "+session_key}}).fail(function(t){return app_status(t),!1}).done(function(t){return user=t,localStorage.setItem("user",user),user.first_name?content_upload("templates/profiles/index.htm"):content_upload("templates/profiles/edit.htm"),!1})}else active_buttons(),content_upload("templates/authorizations/authorization.htm")}function authorization_message(t,o){t=t||0,$(document).find(".authorization_form .form_status").removeClass("_error"),0==t&&$(document).find(".authorization_form .form_status").html(""),0==t&&$(document).find(".authorization_form .form_status").html(o),1==t&&$(document).find(".authorization_form .form_status").addClass("_error").html(o)}$(function(){authorization(),$(document).on("input",'#authorization_form input[name="login"]',function(){var t=$(this).val().replace(/\s/g,"");$(this).val(t.toLowerCase())}),$(document).on("submit","#authorization_form",function(){var t=[];return t=$(this).serializeArray(),$.ajax({url:site_url+"api/v1/accounts/login/",data:t,method:"POST"}).fail(function(t){return t.responseJSON&&t.responseJSON.detail?(console.log(t.responseJSON.detail),authorization_message(1,'<p style="color:#ff7f7f;">'+t.responseJSON.detail+"</p>"),!1):(console.log(t),!1)}).done(function(t){console.log(t),t.token&&(localStorage.setItem("session_key",session_key=t.token),authorization(),t.detail&&authorization_message(1,'<p style="color:#ff7f7f;">'+t.detail+"</p>"))}),!1}),$(document).on("submit","#password_form",function(){return!1}),$(document).on("submit","#password-code_form",function(){return!1}),$(document).on("submit","#password-new_form",function(){return!1}),$(document).on("click","#profile_exit",function(){localStorage.clear(),session_key="",user={},authorization()})});